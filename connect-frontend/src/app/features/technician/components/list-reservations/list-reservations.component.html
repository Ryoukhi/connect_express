<div class="p-6">
  <h2 class="text-xl font-bold mb-4">Réservations confirmées aujourd'hui</h2>

  <div *ngIf="loading" class="text-sm text-slate-400">Chargement…</div>
  <div *ngIf="!loading && reservations.length === 0" class="text-sm text-slate-400">Aucune réservation confirmée aujourd'hui.</div>

  <ul *ngIf="!loading && reservations.length" class="space-y-3">
    <li *ngFor="let r of reservations" class="bg-white p-4 rounded shadow flex justify-between items-start">
      <div>
        <div class="font-bold">{{ r.scheduledTime | date:'HH:mm' }} — {{ r.description || 'Réservation' }}</div>
        <div class="text-sm text-slate-500">{{ r.neighborhood }}{{ r.city ? (', ' + r.city) : '' }} • {{ r.price ? (r.price + ' F') : '' }}</div>
      </div>
      <div class="flex gap-2">
        <button class="px-3 py-1 bg-blue-600 text-white rounded text-sm" (click)="viewDetails(r)">Voir détails</button>
        <a [routerLink]="['/dashboard-technicien/reservation', r.idReservation]" class="px-3 py-1 border rounded text-sm text-blue-600 hover:underline">Voir la page</a>
      </div>
    </li>
  </ul>

  <!-- DETAILS MODAL / PANEL -->
  <div *ngIf="selected" class="fixed inset-0 z-50 flex items-center justify-center bg-black/30">
    <div class="bg-white rounded p-6 w-11/12 md:w-2/3">
      <div class="flex justify-between items-start">
        <h3 class="font-bold text-lg">Détails de la réservation</h3>
        <button (click)="closeDetails()" class="text-slate-400 hover:text-slate-600">✕</button>
      </div>

      <div *ngIf="selectedLoading" class="text-sm text-slate-400 mt-4">Chargement…</div>
      <div *ngIf="selectedError" class="text-sm text-red-500 mt-4">{{ selectedError }}</div>

      <div *ngIf="!selectedLoading && !selectedError" class="mt-4 grid grid-cols-2 gap-4">
        <div>
          <p class="text-sm text-slate-500">Client</p>
          <p class="font-bold">{{ selected.idClient ? ('Client #' + selected.idClient) : 'Client' }}</p>

          <p class="text-sm text-slate-500 mt-3">Adresse</p>
          <p>{{ selected.neighborhood }}{{ selected.city ? (', ' + selected.city) : '' }}</p>
        </div>
        <div>
          <p class="text-sm text-slate-500">Heure prévue</p>
        <p class="font-bold">{{ selected.scheduledTime | date:'EEE, d MMM HH:mm' }}</p>

        <p class="text-sm text-slate-500 mt-3">Prix</p>
        <p class="font-bold">{{ selected.price | number:'1.0-0' }} F</p>
        </div>
      </div>

      <div class="mt-6 flex justify-end gap-2">
        <button class="px-4 py-2 bg-gray-200 rounded" (click)="closeDetails()">Fermer</button>
      </div>
    </div>
  </div>
</div>
